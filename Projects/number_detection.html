<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" name = "Generic Project" content = "width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="../CSS/masterStyleSheet.css">
    <link rel="stylesheet" type="text/css" href="../CSS/projects.css">
    <link rel="stylesheet" type="text/css" href="../CSS/responsive_header.css">
    <link rel="stylesheet" type="text/css" href="../CSS/gallery.css">
    <script src="../JS/image_gallery.js" type="text/javascript"></script>


    <!--        <link rel="stylesheet" type="text/css" href="masterStyleSheet.css">-->
    <title>Python-TensorFlow Number Recognition</title>

</head>

<!--<header id="includedContent">-->

<!--</header>-->
<!--<script>-->
<!--    $("#includedContent").load("/../responsive_header.html");-->
<!--</script>-->
<div class="header">
    <nav class="navbar">
        <a href="../index.html" class="nav-logo">Aiden Stevenson Bradwell</a>
        <ul class="nav-menu">
            <li class="nav-item">
                <a href="../about.html" class="nav-link">About Me</a>
            </li>
            <li class="nav-item">
                <a href="../resumes.html" class="nav-link">Resumes</a>
            </li>
            <li class="nav-item">
                <a href="../index.html#experience" class="nav-link">Work Experience</a>
            </li>

            <li class="nav-item">
                <a href="../education.html" class="nav-link">Education</a>
            </li>
            <li class="nav-item">
                <a href="../index.html#projects" class="nav-link">Projects</a>
            </li>
            <li class="nav-item">
                <a href="../index.html#articles" class="nav-link">Articles</a>
            </li>
        </ul>
        <div class="hamburger">
            <span class="bar"></span>
            <span class="bar"></span>
            <span class="bar"></span>
        </div>
    </nav>
    <script>
        const hamburger = document.querySelector(".hamburger");
        const navMenu = document.querySelector(".nav-menu");

        hamburger.addEventListener("click", mobileMenu);

        function mobileMenu() {
            hamburger.classList.toggle("active");
            navMenu.classList.toggle("active");
        }

        const navLink = document.querySelectorAll(".nav-link");

        navLink.forEach(n => n.addEventListener("click", closeMenu));

        function closeMenu() {
            hamburger.classList.remove("active");
            navMenu.classList.remove("active");
        }
    </script>
</div>

<div class="header_image" style="background-image: url('../Resources/Images/number_recognition/background.png');">
    <h1 class="project_title"><b>Python-TensorFlow Number Recognition</b></h1>
</div>

<body class = "project_page">

    <div class="highlight_grid">
        <div class="text_section">
            <h1 > Overview</h1>
            <p><b>Author:</b> Aiden Stevenson Bradwell</p>
            <p><b>Affiliation:</b> University of Ottawa</p>
            <p><b>Date:</b> December 23rd, 2021</p>
            <p><b>Concepts Used:</b> Python 3, OpenCV, Tensorflow, Neural Networks, Number Recognition</p>

            <br><br>
            <h3>About Program:</h3>
            <p>Submission for CSI4133 Final project, Implementing a Self-Trained Tensorflow network to identify consistent numbers in complex images.
            </p>
        </div>
        <div class="image_section">
            <div class="inner_image_section">
                <img class="featured_image" id="image"/>
                <span class="image_subtitle" id="caption">...caption...</span>
            </div>
        </div>
        <button class="left_button">&laquo;</button>
        <button class="right_button">&raquo;</button>
    </div>
    <br><br>
    <hr>
    <br><br>
    <div class="github_holder"> 
        <a style="align-self: center;" target="_blank" href="https://github.com/ABradwell/Number_recognition"><img src="../Resources/GitHub-Emblem.png" width="250" height="125"></a>
    </div>
    <br><br>
    <hr>
    <br><br>
    <div class="data_holder_double ">
        <div class = "info_section diva1">
            <h1>Network Training Data</h1>
            <table>
                <tr>
                    <th>Class</th>
                    <th># of Training Images</th>
                </tr>
                <tr>
                    <td>Zero</td>
                    <td>1368</td>
                </tr>
                <tr>
                    <td>One</td>
                    <td>588</td>
                </tr>
                <tr>
                    <td>Two</td>
                    <td>144</td>
                </tr>
                <tr>
                    <td>Three</td>
                    <td>109</td>
                </tr>
                <tr>
                    <td>Four</td>
                    <td>105</td>
                </tr>
                <tr>
                    <td>Five</td>
                    <td>184</td>
                </tr>
                <tr>
                    <td>Six</td>
                    <td>119</td>
                </tr>
                <tr>
                    <td>Seven</td>
                    <td>324</td>
                </tr>
                <tr>
                    <td>Eight</td>
                    <td>558</td>
                </tr>
                <tr>
                    <td>Nine</td>
                    <td>493</td>
                </tr>
            </table>
        </div>

        <div class="info_section diva2">
            <h1>Network Structure</h1>
            <table>
                <tr>
                    <th>Layer #</th>
                    <th>Specific Type</th>
                    <th>Settings</th>
                </tr>
                <tr>
                    <td>0</td>
                    <td>Random Flip</td>
                    <td></td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>Random Rotation</td>
                    <td></td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>Random Zoom</td>
                    <td></td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>Rescaling</td>
                    <td></td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>2D Convolutional</td>
                    <td>
                        <ul>
                            <li>16 filters, 3 kernel size</li>
                            <li>Relu activation</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td>5</td>
                    <td>2D Max Pooling</td>
                    <td></td>
                </tr>
                <tr>
                    <td>6</td>
                    <td>2D Convolutional</td>
                    <td>
                        <ul>
                            <li>32 filters, 3 kernel size</li>
                            <li>Relu activation</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td>7</td>
                    <td>2D Max Pooling</td>
                    <td></td>
                </tr>
                <tr>
                    <td>8</td>
                    <td>2D Convolutional</td>
                    <td>
                        <ul>
                            <li>64 filters, 3 kernel size</li>
                            <li>Relu activation</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td>9</td>
                    <td>2D Max Pooling</td>
                    <td></td>
                </tr>
                <tr>
                    <td>10</td>
                    <td>Dropout</td>
                    <td>
                        <ul>
                            <li>Rate of 0.2</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td>11</td>
                    <td></td>
                    <td>
                        <ul>
                            <li>128 units</li>
                            <li>Relu activation</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td>12</td>
                    <td></td>
                    <td>
                        <ul>
                            <li>10 units</li>
                            <li>Relu activation</li>
                        </ul>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <br><br>
    <div class="data_holder_double ">
        <div class = "info_section diva3">
            <h1>Training Stages</h1>
            <h3>Initial Training</h3>
            <p>Initially, the algorithm was applied to separate all number within the image (as determined by the strongest found contours).<br> 
                With these, manual classification was used to separate 50-60 of each number type (0-9).
                The neural network training was run on these manual-classifications.</p>
            <h3>Self-supported Training</h3>
            <p>With a functional, yet inaccurate network running, a classification was run on all images in the set. 
                The results were then manually filtered, creating a significantly large set of accurate data.
                The neural network training is run on this larger dataset, creating a significantly higher accuracy.</p>
        </div>

        <div class="info_section diva4">
            <h1>Algorithm</h1>
            <p>
                1. User provides a file-name (in the form of a number).<br><br>
                2. Image is opened, and preprocessed using a combination of Gaussian Blur, Canny Edge Detection, External Edge Detection<br><br>
                3. Take the four largest contours (most likely the numbers on the image)<br><br>
                4. For each contour, Blur, grayscale, and convert to Network Image required sizes<br><br>
                5. Neural Network run for each number, and value is concatenated and returned<br><br>
            </p>
        </div>
    </div>
    <br><br>
    <div class="data_holder_double ">
        <div class = "info_section diva3">
            <h1>Limitations</h1>
            <p>Correctly Identify all 4 numbers: <b>1294/1324 (97.734%)</b><br><br>
                Correctly Identify all 4 non-corrupted numbers: <b>1300/1324 (98.187%)</b></p>
                <p> With the accuracy of the neural network, it appears that the error lies in incorrectly canny-edged images. 
                    Different threshvalues or a blurring method may provide an increase in accuracy</p>
        </div>
    </div>
    <br><br>
    <hr>
    <!-- THIS SCRIPT IS REQUIRED FOR ALL USE OF THE GALLARY. INCLUDE IT IN ALL PROJECT PAGES. -->
    <script>
        var img = document.getElementById('image');
        var cap = document.getElementById('caption');
        var leftBtn = document.querySelector('.left_button');
        var rightBtn = document.querySelector('.right_button');

        leftBtn.addEventListener('click', changeLeft);
        rightBtn.addEventListener('click', changeRight);


        //Start this baby up
        // https://drive.google.com/drive/folders/1jnTlasAdNVCuRrslf90lznttbT_Ke2b8
        (function init() {
            images = [
                "../Resources/Images/number_recognition/network_structure.PNG",
                "../Resources/Images/number_recognition/training_numbers.PNG",
                "../Resources/Images/number_recognition/first_training_data.PNG",
                "../Resources/Images/number_recognition/second_training.PNG",
                "../Resources/Images/number_recognition/partA_example.gif",
                "../Resources/Images/number_recognition/25650.png",
                "../Resources/Images/number_recognition/38472.png",
                "../Resources/Images/number_recognition/39354.png",
                "../Resources/Images/number_recognition/63115.png",
                
            ];
            captions = [
                "Network Structure",
                "Network Training Data",
                "First Iteration Training Data",
                "Second Iteration Training Data",
                "Example of Stage One (Find Numbers) & Stage Two (Seperate)",
                "Sample Image for detection 1",
                "Sample Image for detection 2",
                "Sample Image for detection 3",
                "Sample Image for detection 4",
            ];
             //Set Initial Featured Image
            img.src = images[0];
            cap.textContent = captions[0]
        })();
    </script>
</body>
<br><br>
</html>